$(document).ready(function(){function n(b){for(var a=0,c=0;c<b.length;c++)b[c].length>a&&(a=b[c].length);a=5>a?5:a;g="";for(b=0;b<a;b++)g+="_"}function o(b){var a=b.indexOf("["),c=b.indexOf("]"),d=[];return-1!=a&&-1!=c&&a<c?(d[0]=b.substring(a+1,c),d[1]=b.substring(0,a),d[2]=b.substring(c+1,b.length),d):!1}function m(){h=activityContent.group.length;e=[];var b="",a='<ul id="sentences">',c=[],d=[],f=0;for(i=0;i<h;i++){c[i]=activityContent.group[i].sentence;var j=o(c[i]);!1!=j?(f++,a+='<li class="sentence">'+
j[1]+'<span class="blank"><span>____</span></span> '+j[2]+'<span class="trueFalseIcon"></span></li>',e[i]=j[0],d[i]=j[0]):(e[i]="",d[i]="")}a+="</ul>";d=shuffle(d);for(i=0;i<h;i++)b+='<span class="word">'+d[i]+"</span> ";$("#word-list").append($(b));$("#sentence-list").append($(a));n(e);$(".blank span").text(g);$("#word-list span").draggable({revert:"invalid",helper:"clone"});$(".blank").droppable({accept:"#word-list span, .blank span",over:function(){$(this).addClass("blank-over")},out:function(){$(this).removeClass("blank-over")},
drop:function(b,a){playSound(Ucan.Resource.Audio.getClickedSound());$(this).removeClass("blank-over");a.draggable.parent().hasClass("blank")&&(a.draggable.parent().append($(this).children()),$(this).append(a.draggable));a.draggable.parent().hasClass("blank")||($(this).children().hasClass("word")&&a.draggable.parent().append($(this).children()),$(this).children().remove(),$(this).append(a.draggable))}});$("#word-list").droppable({accept:".blank span",drop:function(b,a){playSound(Ucan.Resource.Audio.getClickedSound());
a.draggable.parent().append("<span>"+g+"</span>");$(this).append(" ").append(a.draggable)}})}var k=!0,l=!1,e=[],h=activityContent.group.length,g;m();$("#show-answer").click(function(){var b=0;$(".sentence .blank").each(function(){$(this).children().html('<span class="word">'+e[b]+"</span>");b++});$(".sentence .blank").fadeOut(400).fadeIn(500)});var f=0;$("#loadResult").click(function(){if(k){k=!1;$(".ui-draggable").draggable("disable");$(".cp-jplayer").jPlayer("stop");f=0;playSound(Ucan.Resource.Audio.getShowResultSound());
var b=0;$(".sentence .blank").each(function(){$(this).children().text()==e[b]?(f++,insertTrueFalseIcon(!0,$(this).parent().children(".trueFalseIcon"))):insertTrueFalseIcon(!1,$(this).parent().children(".trueFalseIcon"));b++});$(".true-icon").css({margin:"-8px 0 0 0"});$(".false-icon").css({margin:"0 0 0 0"});$(".true-icon, .false-icon").ucanAnimateTrueFalseIcon();$("#num-of-correct-answers-result").text(f+"/"+h);score=Math.floor(100*(f/h));$("#score-text").text(score);$("#show-result").show("slide",
{direction:"left"},Ucan.Constants.getShowResultSpeed());l=!0}});$("#redo").click(function(){l&&(l=!1,$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),function(){k=!0;$("#sentence-list").html("");$("#word-list").html("");m()}))})});
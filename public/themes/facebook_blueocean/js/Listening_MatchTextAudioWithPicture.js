$(document).ready(function(){function h(){var a=0;$(".dialog").each(function(){$(this).height()>a&&(a=$(this).height())});0<a&&$(".dialog").height(a)}function j(){var a=[],b="";for(i=0;i<f;i++)a[a.length]='<div class="character-picture-holder" id="picture_'+i+'" ><img class="character-picture character-picture-normal" src="'+resourceUrl+activityContent.group[i].pictures+'" data-id="'+i+'" /></div>';a=shuffle(a);for(k=0;k<a.length;k++)b+=a[k];$("#pictures-container").append(b);$("#sentences-container").append("");
$(".character-picture").draggable({revert:"invalid",helper:"clone"})}var f=activityContent.group.length,c=!0,d=0.75,g=!1;j();$(".dialog-audio-container").last().css("margin-right",0);var l=new Image;l.onload=function(){d=this.height/this.width;$(".represent-picture").width(Math.floor($(".represent-picture").height()/d));var a=Math.floor($(".character-picture").height()/d);$(".character-picture").width(a);$(".dialog-audio-container").width(160+a);$(".dialog").width(125+a)};l.src=activityContent.group[0].pictures;
h();setTimeout(function(){h()},1E3);$(".dialog-audio-container").droppable({accept:".character-picture",over:function(){$(this).children(".represent-picture").removeClass("represent-picture-unmatch").addClass("represent-picture-over")},out:function(){$(this).children(".represent-picture").removeClass("represent-picture-over").addClass("represent-picture-unmatch")},drop:function(a,b){c&&(playSound(Ucan.Resource.Audio.getClickedSound()),b.draggable.parent().hasClass("character-picture-holder")?(0<$(this).children(".represent-picture").children(".character-picture").length&&
($("#picture_"+$(this).children(".represent-picture").children(".character-picture").attr("data-id")).show().switchClass("character-picture-normal","character-picture-slash",500,function(){$(this).switchClass("character-picture-slash","character-picture-normal")}),$(this).children(".represent-picture").children().remove()),$(this).children(".represent-picture").append(b.draggable.clone().draggable({revert:"invalid",helper:"clone"})).switchClass("represent-picture-over","represent-picture-slash",500,
function(){$(this).switchClass("represent-picture-slash","represent-picture-match")}),b.draggable.parent().hide()):(0<$(this).children(".represent-picture").children().length?b.draggable.parent().append($(this).children(".represent-picture").children()).switchClass("represent-picture-match","represent-picture-slash",500,function(){$(this).switchClass("represent-picture-slash","represent-picture-match")}):b.draggable.parent().switchClass("represent-picture-match","represent-picture-slash",500,function(){$(this).switchClass("represent-picture-slash",
"represent-picture-unmatch")}),$(this).children(".represent-picture").append(b.draggable.clone().draggable({revert:"invalid",helper:"clone"})).switchClass("represent-picture-over","represent-picture-slash",500,function(){$(this).switchClass("represent-picture-slash","represent-picture-match")}),b.draggable.remove()))}});$("#pictures-container").droppable({accept:".character-picture",drop:function(a,b){c&&(playSound(Ucan.Resource.Audio.getClickedSound()),b.draggable.parent().hasClass("character-picture-holder")||
($("#picture_"+b.draggable.attr("data-id")).show().switchClass("character-picture-normal","character-picture-slash",500,function(){$(this).switchClass("character-picture-slash","character-picture-normal")}),b.draggable.parent().switchClass("represent-picture-match","represent-picture-slash",500,function(){$(this).switchClass("represent-picture-slash","represent-picture-unmatch")}),b.draggable.remove()))}});var e=0;$("#loadResult").click(function(){c&&(c=!1,$(".cp-jplayer").jPlayer("stop"),$(".character-picture").draggable("disable"),
playSound(Ucan.Resource.Audio.getShowResultSound()),e=0,$(".dialog-audio-container").each(function(){$(this).children(".represent-picture").attr("data-id")==$(this).children(".represent-picture").children("img").attr("data-id")?(e++,$(this).children(".represent-picture").append('<div class="represent-picture-mask"></div><div class="true-false-icon"><img class="true-icon" src="'+baseUrl+'/themes/blueocean/img/true-false-tick-white-108.png" /></div>')):$(this).children(".represent-picture").append('<div class="represent-picture-mask"></div><div class="true-false-icon"><img class="false-icon" src="'+
baseUrl+'/themes/blueocean/img/true-false-cross-white-108.png" /></div>')}),$(".represent-picture-mask").width($(".represent-picture-mask").height()/d),$(".true-false-icon").width($(".true-false-icon").height()/d),$(".true-icon, .false-icon").ucanAnimateTrueFalseIcon(),$("#num-of-correct-answers-result").text(e+"/"+f),score=Math.floor(100*(e/f)),$("#score-text").text(score),$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed()),g=!0)});$("#redo").click(function(){g&&
(g=!1,$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),function(){c=!0;$("#pictures-container").html("");$(".represent-picture").children().remove();$(".represent-picture").switchClass("represent-picture-match","represent-picture-unmatch");e=0;j()}))});$("#show-answer").click(function(){$(".represent-picture").each(function(){$(this).switchClass("represent-picture-unmatch","represent-picture-match");$(this).html('<img class="character-picture character-picture-normal" src="'+
resourceUrl+activityContent.group[$(this).attr("data-id")].pictures+'">').fadeOut(500).fadeIn(500)})})});
var canPlay=!0,wordCount,unShowClickResult=0,pictures=[],words=[],canClickShowAnswer=!1,canClickRedo=!1,i,j,numberOfGroup,keys=[],score;
$(document).ready(function(){function f(){for(var b=[],a=0;a<keys.length;a++){var c=keys[a].group;-1==b.indexOf(c)&&b.push(c)}numberOfGroup=b.length;if(1<numberOfGroup)for(a=0;a<numberOfGroup;a++)$("#groups-container").append('<div class="concrete-group order'+a+'"></div>'),$(".global-tab-container").append('<div class="unselected" data-order="'+a+'">'+(a+1)+"</div>");else $("#groups-container").append('<div class="concrete-group order1"></div>'),$(".global-activity-guide").removeClass("with-tab"),
$(".global-tab-container, #next-tab, #back-tab").remove();$(".concrete-group").each(function(m){$(this).append('<div class="word-container"></div><div class="picture-container"></div>');var e=[],c=[];for(a=0;a<keys.length;a++)keys[a].group==b[m]&&(e.push(pictures[a]),c.push(words[a]));shuffle(e);shuffle(c);for(a=0;a<e.length;a++)$(this).children(".word-container").append('<div class="word" data-id="'+c[a].id+'">'+c[a].text+"</div>"),$(this).find(".picture-container").append('<div class="wrapper"><img src="'+
resourceUrl+e[a].link+'" class="img-main" data-id="'+e[a].id+'" alt="Image"/></div>')});l();$(".word-container .word").draggable({revert:"invalid",helper:"clone",zIndex:3E3,start:function(a,b){b.helper.toggleClass("dragging");$(this).data("draggable").offset.click.top=22;$(this).data("draggable").offset.click.left=$(b.helper).width()/2}});$(".word-container .word").hover(function(){$(this).parent().hasClass("wrapper")||$(this).stop(!0,!0).css("line-height","23px").animate({fontSize:"20px"},300)},
function(){$(this).parent().hasClass("wrapper")||$(this).css("line-height","22px").animate({fontSize:"16px"},100)});$(".picture-container .img-main").droppable({accept:".word",over:function(){$(this).parent().addClass("over")},out:function(){$(this).parent().removeClass("over")},drop:function(a,b){playSound(Ucan.Resource.Audio.getClickedSound());$(this).parent().removeClass("over");-1==$(this).siblings(".word").index(b.draggable)&&(0<$(this).siblings(".word").size()&&b.draggable.after($(this).stop(!0,
!0).siblings(".word").hide().fadeIn(500)),$(this).after(b.draggable.stop(!0,!0).hide().fadeIn(500)))}});$(".word-container").droppable({accept:".picture-container .word",over:function(){$(this).addClass("over")},out:function(){$(this).removeClass("over")},drop:function(a,b){$(this).removeClass("over");playSound(Ucan.Resource.Audio.getClickedSound());$(this).append(b.draggable)}});$(".global-tab-container > *").click(function(){d(parseInt($(this).attr("data-order")))});$("#next-tab").click(function(){var a=
parseInt($(".global-tab-container .selected").attr("data-order"));0<=a&&a<numberOfGroup&&d(a+1)});$("#back-tab").click(function(){var a=$(".global-tab-container .selected").attr("data-order");0<=a&&0<a&&d(a-1)});d(0)}function l(){var b=new Image;b.src=pictures[0].link;b.onload=function(){var a=b.height*$(".picture-container .wrapper:first").width()/b.width;$(".picture-container .wrapper").height(a)}}function d(b){c++;$(".global-tab-container").ucanMoveToTab(b);$(".concrete-group.order"+b).stop(!0,
!0).fadeIn(500).siblings(".concrete-group").hide()}var c=0;wordCount=activityContent.group.length;for(i=0;i<wordCount;i++){var g={};g.id=i;g.link=$.trim(activityContent.group[i].picture);pictures[i]=g;var h={};h.id=i+7;h.text=$.trim(activityContent.group[i].word);words[i]=h;var k={};k.picID=g.id;k.wordID=h.id;k.group=$.trim(activityContent.group[i].page?activityContent.group[i].page:1);keys[i]=k}f();(function(){$("#groups-container .concrete-group").each(function(){var b=Math.max($(this).children(".word-container").height(),
$(this).children(".picture-container").height());$(this).css("min-height",b+4)})})();$("#show-answer").click(function(){canClickShowAnswer||(playSound(Ucan.Resource.Audio.getShowAnswerSound()),canClickShowAnswer=!0,$(".word-container .word, .picture-container .word").each(function(){var b=$(this).attr("data-id"),a=$(this);$(".picture-container .img-main").each(function(){var c=$(this).attr("data-id");if(parseInt(c)+7==b)return $(this).after(a),!1})}),$(".picture-container .word").stop(!0,!0).fadeOut(500).fadeIn(500),
$(".word-container").html(""))});$("#loadResult").click(function(){$(document).keyup(function(b){13==b.keyCode&&$("#multipage-confirm-dialog-button-no").click()});1==c&1<numberOfGroup?(unShowClickResult++,1==unShowClickResult&&($(".overlay-black").show(),$("#multipage-confirm-dialog").fadeIn(500))):loadResult()});$("#redo").click(function(){c=unShowClickResult=0;canClickRedo&&(canClickRedo=!1,$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),function(){$("#groups-container").html("");
$(".word-container").html("");$(".global-tab-container").html("");f();canPlay=!0;canClickShowAnswer=!1}))})});
function loadResult(){canPlay&&(canPlay=!1,$(".ui-draggable").draggable("disable"),playSound(Ucan.Resource.Audio.getShowResultSound()),numberOfTrueAnswers=0,$(".picture-container .wrapper").each(function(){if(0<$(this).children(".word").size()){for(var f=$(this).children(".img-main").attr("data-id"),l=$(this).find(".word").attr("data-id"),d=!1,c=0;c<keys.length;c++)if(f==keys[c].picID&&l==keys[c].wordID){d=!0;break}d?(numberOfTrueAnswers++,$(this).prepend(Ucan.Resource.Image.getIconTrueWithoutShadow())):
$(this).prepend(Ucan.Resource.Image.getIconFalseWithoutShadow())}else $(this).children().first().before(Ucan.Resource.Image.getIconFalseWithoutShadow())}),$(".picture-container img.true, .picture-container img.false").css({"margin-top":function(){return($(this).parent(".wrapper").height()-40-$(this).height())/2}}),$(".wrapper .true, .wrapper .false").ucanAnimateTrueFalseIcon(),$("#num-of-correct-answers-result").text(numberOfTrueAnswers+"/"+wordCount),score=Math.floor(100*(numberOfTrueAnswers/wordCount)),
$("#score-text").text(score),$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed()),canClickRedo=!0)};
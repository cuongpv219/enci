$(document).ready(function(){function n(a,c){c.helper.css({width:"75px",height:75*e+"px","z-index":"3"});$(this).data("draggable").offset.click.top=37;$(this).data("draggable").offset.click.left=37}function o(){var a=new Image;a.onload=function(){e=this.height/this.width;$(".represent-picture").height($(".represent-picture").width()*e);$(".character-picture").height($(".character-picture").width()*e);$(".sentence-holder").height($(".represent-picture").width()*e+20)};a.src=activityContent.group[0].character;
7>g&&(a=Math.round((960/g-$(".character-picture").width())/2),$(".character-picture-holder").css({"margin-left":a+"px","margin-right":a+"px"}))}function m(){c=[];var a=[],d="",h="",f=shuffle(activityContent.group);for(i=0;i<g;i++)-1==$.inArray(f[i].character,c)?(a[a.length]='<div class="character-picture-holder" id="picture_'+c.length+'" ><img class="character-picture character-picture-normal" src="'+resourceUrl+f[i].character+'" data-id="'+c.length+'" /></div>',void 0!=f[i].sentence&&(h+='<div class="sentence-holder"><div class="represent-picture represent-picture-unmatch" data-id="'+
c.length+'"></div><span class="sentence" sentenceId="'+i+'">'+f[i].sentence.replace(/\[\[/g,'<span class="exactly">').replace(/\]\]/g,"</span>")+"</span></div>"),c[c.length]=f[i].character):void 0!=f[i].sentence&&(h+='<div class="sentence-holder"><div class="represent-picture represent-picture-unmatch" data-id="'+$.inArray(f[i].character,c)+'"></div><span class="sentence">'+f[i].sentence.replace(/\[\[/g,'<span class="exactly">').replace(/\]\]/g,"</span>")+"</span></div>");a=shuffle(a);for(k=0;k<a.length;k++)d+=
a[k];$("#pictures-container").append(d);$("#sentences-container").append(h);o();$(".character-picture").draggable({revert:"invalid",helper:"clone",start:n});$(".sentence-holder").droppable({accept:".character-picture",over:function(){$(this).children(".represent-picture").removeClass("represent-picture-unmatch").addClass("represent-picture-over")},out:function(){$(this).children(".represent-picture").removeClass("represent-picture-over").addClass("represent-picture-unmatch")},drop:function(a,b){j&&
(playSound(Ucan.Resource.Audio.getClickedSound()),b.draggable.parent().hasClass("character-picture-holder")?(0<$(this).children(".represent-picture").children(".character-picture").length&&($("#picture_"+$(this).children(".represent-picture").children(".character-picture").attr("data-id")).show().switchClass("character-picture-normal","character-picture-slash",0,function(){$(this).switchClass("character-picture-slash","character-picture-normal")}),$(this).children(".represent-picture").children().remove()),
$(this).children(".represent-picture").append(b.draggable.clone().css({width:"75px",height:75*e+"px"}).draggable({revert:"invalid",helper:"clone"})).switchClass("represent-picture-over","represent-picture-slash",0,function(){$(this).switchClass("represent-picture-slash","represent-picture-match")}),b.draggable.parent().hide()):(0<$(this).children(".represent-picture").children().length?b.draggable.parent().append($(this).children(".represent-picture").children()).switchClass("represent-picture-match",
"represent-picture-slash",0,function(){$(this).switchClass("represent-picture-slash","represent-picture-match")}):b.draggable.parent().switchClass("represent-picture-match","represent-picture-slash",0,function(){$(this).switchClass("represent-picture-slash","represent-picture-unmatch")}),$(this).children(".represent-picture").append(b.draggable.clone().draggable({revert:"invalid",helper:"clone"})).switchClass("represent-picture-over","represent-picture-slash",0,function(){$(this).switchClass("represent-picture-slash",
"represent-picture-match")}),b.draggable.remove()))}});$("#pictures-container").droppable({accept:".character-picture",drop:function(a,b){j&&(playSound(Ucan.Resource.Audio.getClickedSound()),b.draggable.parent().hasClass("character-picture-holder")||($("#picture_"+b.draggable.attr("data-id")).show().switchClass("character-picture-normal","character-picture-slash",0,function(){$(this).switchClass("character-picture-slash","character-picture-normal")}),b.draggable.parent().switchClass("represent-picture-match",
"represent-picture-slash",0,function(){$(this).switchClass("represent-picture-slash","represent-picture-unmatch")}),b.draggable.remove()))}})}var g=activityContent.group.length,j=!0,e=0.75,c=[],l=!1;m();var d=0;$("#loadResult").click(function(){j&&(j=!1,$(".character-picture").draggable("disable"),playSound(Ucan.Resource.Audio.getShowResultSound()),d=0,$(".sentence-holder").each(function(){$(this).children(".represent-picture").attr("data-id")==$(this).children(".represent-picture").children("img").attr("data-id")?
(d++,$(this).children(".represent-picture").append('<div class="represent-picture-mask"></div><img class="true-icon true-false-icon" src="'+baseUrl+'/themes/blueocean/img/true-false-tick-white-108.png" />')):$(this).children(".represent-picture").append('<div class="represent-picture-mask"></div><img class="false-icon true-false-icon" src="'+baseUrl+'/themes/blueocean/img/true-false-cross-white-108.png" />')}),$(".represent-picture-mask").height($(".represent-picture-mask").width()*e),$(".true-icon, .false-icon").ucanAnimateTrueFalseIcon(),
$("#num-of-correct-answers-result").text(d+"/"+g),score=Math.floor(100*(d/g)),$("#score-text").text(score),$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed()),l=!0)});$("#redo").click(function(){l&&(l=!1,$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),function(){j=!0;$("#pictures-container").html("");$("#sentences-container").html("");d=0;m()}))});$("#show-answer").click(function(){$(".represent-picture").each(function(){$(this).switchClass("represent-picture-unmatch",
"represent-picture-match");$(this).html('<img class="character-picture-normal" src="'+resourceUrl+c[$(this).attr("data-id")]+'" style="width: 75px; height: '+75*e+'px; ">').stop(!0,!0).fadeOut(500).fadeIn(500)})})});
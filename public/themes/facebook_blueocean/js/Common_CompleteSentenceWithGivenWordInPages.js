var canPlay=!0,canClickRedo=!1,count,unShowClickResult=0,score;
$(document).ready(function(){function e(a){$(".global-tab-container").ucanMoveToTab(a);$(".sentence").hide();$(".picture-container").hide();$(".words").hide();activityContent.group[a].picture?($("#picture-container_"+a).show(),$("#word-list").addClass("shortwidth").removeClass("longwidth"),$("#activity-guide").addClass("shortwidth1").removeClass("longwidth1"),$("#sentences").addClass("shortwidth2").removeClass("longwidth2")):($("#word-list").addClass("longwidth").removeClass("shortwidth"),$("#activity-guide").removeClass("shortwidth1").addClass("longwidth1"),
$("#sentences").addClass("longwidth2").removeClass("shortwidth2"));$("#sentence_"+a).show();$("#words_"+a).show();g=parseInt(a);c++}function d(){count=activityContent.group.length;var a="",c='<div id="sentences">',d=[];k=[];for(var g="",l="",m=/\[([^\]])+\]/g,b=0;b<count;b++)h[b]=activityContent.group[b].picture,g+='<div class="picture-container" id="picture-container_'+b+'"> <img class="picture" src="'+resourceUrl+h[b]+'" "/> </div>',l+='<div id="sentence-button_'+(count-b-1)+'" data-order="'+(count-
b-1)+'" class="inactive-button unselected">'+(count-b)+'<img class="false" src="'+baseUrl+'/themes/blueocean/img/tab-false-icon.png"></img><img class="true" src="'+baseUrl+'/themes/blueocean/img/tab-true-icon.png"></img></div>',d[b]=activityContent.group[b].sentence.replace(m,'<span class="blank"> ______</span>').replace("[","").replace("]",""),c+='<div id = "sentence_'+b+'" class="sentence">'+d[b]+"</div>";c+="</div>";k=shuffle(k);for(b=0;b<count;b++){for(var d=activityContent.group[b].words.split(","),
j=activityContent.group[b].sentence.match(m),f=0;f<j.length;f++)j[f]=j[f].toString().substring(1,j[f].toString().length-1),d.push(j[f]);for(var d=shuffle(d),a=a+('<div class = "words" id="words_'+b+'">'),f=0;f<d.length;f++)a+='<span id="word_'+b+"_"+f+'" class="word">'+d[f]+"</span> ";a+="</div>"}$("#word-list").append($(a));$("#picture-board").append(g);$("#sentence-list").append($(c));for(b=0;b<count;b++){var n=0;$("#sentence_"+b).find(".blank").each(function(){$(this).attr("id","blank_"+b+"_"+
n);n++})}$("#question-link").append(l);$(".true").hide();$(".false").hide();$("#word-list span").draggable({revert:"invalid",helper:"clone"});$(".blank").droppable({accept:".words span, .word ",over:function(){$(this).addClass("blank-over")},out:function(){$(this).removeClass("blank-over")},drop:function(b,a){$(this).removeClass("blank-over");playSound(Ucan.Resource.Audio.getClickedSound());if(a.draggable.parent().hasClass("blank")){if(a.draggable.attr("id")==$(this).children().attr("id"))return;
$(this).children().hasClass("word")?a.draggable.parent().append($(this).children().css({color:"#f5770f"})):a.draggable.parent().append(" ______ ").css({color:"#000"});$(this).html("").append(a.draggable.css({color:"#f5770f"}))}a.draggable.parent().hasClass("blank")||($(this).children().hasClass("word")&&a.draggable.parent().append($(this).children(".word").css({color:""})),$(this).html("").append(a.draggable.css({color:"#f5770f"})))}});$(".inactive-button").click(function(){var a=$(this).attr("data-order");
e(a)});$(".words").droppable({accept:".blank span",drop:function(a,b){playSound(Ucan.Resource.Audio.getClickedSound());b.draggable.css({color:""});b.draggable.parent().append(" ______ ").css({color:""});$(this).append(" ").append(b.draggable).css({color:""})}});e(0);1==count&&($("#question-link").hide(),$("#prev-link").hide(),$("#next-link").hide(),$("#loadResult").css({margin:"0 auto","float":"none"}))}var c=0,h=[],k=[];$("#next-link").click(function(){g<count-1&&e(g+1)});$("#prev-link").click(function(){0<
g&&e(g-1)});var g=0;d();$("#show-answer").click(function(){for(i=0;i<count;i++){var a=0,c=[],c=activityContent.group[i].sentence.match(/\[([^\]])+\]/g);$("#sentence_"+i+" .blank").each(function(){$(this).html("").append('<span class="word">'+c[a].substring(1,c[a].length-1)+"</span>").css({color:"#f5770f"}).fadeOut(500).fadeIn(500);a++})}playSound(Ucan.Resource.Audio.getShowResultSound())});$("#loadResult").click(function(){$(document).keyup(function(a){13==a.keyCode&&$("#multipage-confirm-dialog-button-no").click()});
1==c&&1<count?(unShowClickResult++,1==unShowClickResult&&($(".overlay-black").show(),$("#multipage-confirm-dialog").fadeIn(500))):loadResult()});$("#redo").click(function(){c=unShowClickResult=0;canClickRedo&&(canClickRedo=!1,$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),function(){canPlay=!0;$("#word-list").html("");$("#sentence-list").html("");$("#picture-board").html("");$("#question-link").html("");h=[];k=[];d()}))})});
function loadResult(){if(canPlay){canPlay=!1;$(".ui-draggable").draggable("disable");for(var e=numberOfTrueAnswers=0;e<count;e++){for(var d=[],d=activityContent.group[e].sentence.match(/\[([^\]])+\]/g),c=0;c<d.length;c++)d[c]=d[c].toString().substring(1,d[c].toString().length-1);for(var h=!0,c=0;c<d.length;c++)$("#blank_"+e+"_"+c).text()!=d[c]&&(h=!1);h?(numberOfTrueAnswers++,1<count?($("#sentence-button_"+e).find(".true").show(),$("#sentence-button_"+e).find(".true").fadeOut(500).fadeIn(500).fadeOut(500).fadeIn(500).fadeOut(500).fadeIn(500)):
insertTrueFalseIconAfter(!0,$("#sentence_"+e+" .blank"))):1<count?($("#sentence-button_"+e).children(".false").show(),$("#sentence-button_"+e).children(".false").fadeOut(500).fadeIn(500)):insertTrueFalseIconAfter(!1,$("#sentence_"+e+" .blank"))}playSound(Ucan.Resource.Audio.getShowResultSound());$(".true-icon, .false-icon").ucanAnimateTrueFalseIcon();$("#num-of-correct-answers-result").text(numberOfTrueAnswers+"/"+count);score=Math.floor(100*(numberOfTrueAnswers/count));$("#score-text").text(score);
$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed());canClickRedo=!0}};
$(document).ready(function(){function o(a){var b=a.indexOf("["),c=a.indexOf("]"),e=[];return-1!=b&&-1!=c&&b<c?(e[0]=a.substring(b+1,c),e[1]=a.substring(0,b),e[2]=a.substring(c+1,a.length),e):!1}function p(a){for(var b=0,c=0;c<a.length;c++)a[c].length>b&&(b=a[c].length);h="";b=5>b?5:b;for(a=0;a<b;a++)h+="_"}function n(){j=activityContent.group.length;var a="",b='<ul id="sentences">',c=[];f=[];g=[];var e=0;for(i=0;i<j;i++){c[i]=activityContent.group[i].sentence;var d=o(c[i]);!1!=d?(e++,b+='<li class="sentence">'+ e+". "+d[1]+'<span class="blank" id="content'+i+'"><span class="underscore"></span></span> '+d[2]+"</li>",f[i]=d[0],g[i]=d[0]):(f[i]="",g[i]="")}p(f);b+="</ul>";g=shuffle(g);for(i=0;i<j;i++)a+='<span class="word">'+g[i].toLowerCase()+"</span> ";$("#word-list").append($(a));$("#sentence-list").append($(b));$(".underscore").text(h);$("#reading-container").hover(function(){$(".jspVerticalBar").stop(!0,!0).fadeIn(200)},function(){setTimeout('$(".jspVerticalBar").fadeOut(200);',1E3)});$("#reading-container").scroll(function(){$(".jspVerticalBar").stop(!0, !0).show()});$(document).mouseup(function(){k||$(".jspVerticalBar").fadeOut(200)});$("#reading-container").mouseover(function(){$(".jspVerticalBar").stop(!0,!0).show();k=!0});$("#reading-container").mouseout(function(){k=!1});$("#reading-board").height()>$("#activity-board").height()?(500<$("#activity-board").height()?(a=$("#activity-board").height(),$("#reading-container").height(a),$("#reading-board").height(a),$("#activity-board").height(a)):($("#reading-container").height(500),$("#activity-board").height(500), $("#reading-board").height(500)),$("#reading-container").jScrollPane({autoReinitialise:!0}),$("#sentence-list").height($("#activity-board").height()-$("#submitDiv").height()-$("#word-list").height()-$("#activity-guide").height()-120)):$("#reading-board").height($("#activity-board").height());$("#word-list span").draggable({revert:"invalid",helper:"clone"});$("#sentences li").droppable({accept:"#word-list span, #sentences li span ",over:function(){$(this).find(".underscore").addClass("blank-over")}, out:function(){$(this).find(".underscore").removeClass("blank-over")},drop:function(a,b){$(this).find(".underscore").removeClass("blank-over");playSound(Ucan.Resource.Audio.getClickedSound());if(b.draggable.parent().hasClass("blank")&&$(this).children().hasClass("blank")){b.draggable.parent().append($(this).children(".blank").children("span"));$(this).children(".blank").append(b.draggable)}if(!b.draggable.parent().hasClass("blank")&&$(this).children().hasClass("blank")){$(this).children(".blank").children().hasClass("word")&& b.draggable.parent().append($(this).children(".blank").children("span"));$(this).children(".blank").children("span").remove();$(this).children(".blank").append(b.draggable)}}});$("#word-list").droppable({accept:"#sentences li span",drop:function(a,b){playSound(Ucan.Resource.Audio.getClickedSound());b.draggable.parent().append("<span>"+h+"</span>");$(this).append(" ").append(b.draggable)}})}var l=!0,k=!1,m=!1,j=activityContent.group.length,h,f=[],g=[];n();$("#show-answer").click(function(){var a=0; $(".sentence .blank").each(function(){iconPos="#content"+a;$(this).children().text(f[a]).switchClass("underscore","word");a++});$(".blank").fadeOut(500).fadeIn(500)});var d=0;$("#loadResult").click(function(){if(l){l=!1;$(".ui-draggable").draggable("disable");d=0;playSound(Ucan.Resource.Audio.getShowResultSound());var a=0;$(".sentence .blank").each(function(){iconPos="#content"+a;$(this).children().text()==f[a].toLowerCase()?(d++,insertTrueFalseIconAfter(!0,iconPos)):insertTrueFalseIconAfter(!1,iconPos); a++});$(".true-icon").fadeOut(500).fadeIn(500).fadeOut(500).fadeIn(500).fadeOut(500).fadeIn(500);$(".false-icon").fadeOut(500).fadeIn(500);10>d?$("#num-of-correct-answers-result").html("0"+d):$("#num-of-correct-answers-result").html(d);score=Math.floor(100*(d/j));10>score?$("#score-text").html("0"+score):$("#score-text").html(score);$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed());m=!0}});$("#redo").click(function(){m&&(m=!1,$("#show-result").hide("slide",{direction:"left"}, Ucan.Constants.getHideResultSpeed(),function(){l=!0;$("#word-list").html("");$("#sentence-list").html("");n()}))})});
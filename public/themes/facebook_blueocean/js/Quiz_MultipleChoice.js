$(document).ready(function(){function k(e){$(".global-tab-container").ucanMoveToTab(e);$("#questions").children().hide();var c=0,b=!1;for(a=0;a<h;a++)void 0==activityContent.question[a].page?0==e&&(b=!0,c<a&&(c=a),$("#question-container_"+a).show()):activityContent.question[a].page==parseInt(e)+1&&(b=!0,$("#question-container_"+a).show(),c<a&&(c=a));b&&$("#question-container_"+c).css({"border-bottom":"none"});$("#picture-board_"+e).show().siblings().hide();void 0!=activityContent.page?void 0!=activityContent.page[e]? void 0!=activityContent.page[e].picture?(c="",c='<img class="picture" src='+resourceUrl+activityContent.page[e].picture+">",$("#picture-board_"+e).html(c),$("#activity-board").addClass("havepicture").removeClass("nopicture")):$("#activity-board").addClass("nopicture").removeClass("havepicture"):$("#activity-board").addClass("nopicture").removeClass("havepicture"):$("#activity-board").addClass("nopicture").removeClass("havepicture");i=parseInt(e);$("#activity-board").css("height","");$("#activity-board").height()< $("#reading-board").height()&&$("#activity-board").height($("#reading-board").height())}function n(){for(var e=0,c=0;c<activityContent.page.length;c++)for(var b=0;b<h;b++)void 0==activityContent.question[b].page?0==c&&$("#question-container_"+b+" .order-question").append(++e+"."):activityContent.question[b].page==c+1&&$("#question-container_"+b+" .order-question").append(++e+".")}function o(){$("#main-board > div").show();$("#question-link").show();$("#result-container").hide();l=!0;for(var e="", c="",b="",a=0;a<d.length;a++)b+='<div id="picture-board_'+a+'"></div>',e+='<div id="sentence-button_'+(d.length-a-1)+'" data-order="'+(d.length-a-1)+'" class="inactive-button unselected">'+(d.length-a)+"</div>";for(var a=0;a<h;a++){for(var f=activityContent.question[a].ask.split("||"),g=activityContent.question[a].choice.split("||"),c=c+('<div id="question-container_'+a+'" class="question-container">'),c=1<f.length?c+('<p class="ask-container"><span class="order-question"></span>'+f[0]+' <span class ="blank">_______ </span> '+ f[1]+"</p>"):c+('<p class="ask-container"><span class="order-question"></span>'+f[0]+"</p>"),f=0;f<g.length;f++)c+='<div value="0" id="choice-container_'+a+"_"+f+'" class="choice-container" style="color: black;"><div value="0" class="choice global-choice-square" id="check_'+a+"_"+f+'"></div><label for="radio_'+a+"_"+f+'">'+g[f].split("--")[0]+"</label></div>";c+="</div>"}$("#reading-board").append(b);$("#question-link").append(e);$("#questions").append(c);k(0);2>d.length&&($("#question-link").hide(), $("#next-link").hide(),$("#prev-link").hide(),$("#finish").css({"float":"none",margin:"0 auto"}));$(".inactive-button").click(function(){var a=$(this).attr("data-order");k(a)});$(".choice-container").click(function(){if(l){playSound(Ucan.Resource.Audio.getClickedSound());var a=$(this).text();$(this).parent().find(".blank").html(a).css({color:"#f8883c","font-size":"14px"});if($(this).attr("value")=="0"){$(this).attr("value","1");$(this).siblings().attr("value",0);$(this).css({color:"#000"});$(this).children(".choice").addClass("checked"); $(this).siblings().children().removeClass("checked")}}})}for(var h=activityContent.question.length,p=[],l=!0,m=[],q=activityContent.sentenceTitle,i=0,j=[],d=[],a=0;a<h;a++)void 0!=activityContent.question[a].page?-1==jQuery.inArray(parseInt(activityContent.question[a].page),d)&&d.push(parseInt(activityContent.question[a].page)):-1==jQuery.inArray(1,d)&&d.push(1);for(var a=0;a<activityContent.result.length;a++)j[a]=activityContent.result[a].totalscore,m[a]=activityContent.result[a].result_reading; (function(){for(var a=0;a<h;a++){var c=activityContent.question[a];p.push(c.reading);m.push(c.result_reading)}})();o();n();$("#next-link").click(function(){i<d.length-1&&k(i+1)});$("#prev-link").click(function(){0<i&&k(i-1)});$("#quizRedo").click(function(){$("#reading-board").html("");$("#question-link").html("");$("#questions").html("");$(".store").html("");$("#topbar").html("");$("#main-board").css({"min-height":""});o();n()});$("#finish").click(function(){var a=0,c=0;void 0==activityContent.result&& window.location.replace(nextActivityUrl);if(l){l=!1;for(var b=0;b<h;b++){for(var d=0,f=activityContent.question[b].choice.split("||"),g=0;g<f.length;g++)parseInt(f[g].split("--")[1])>d&&(d=parseInt(f[g].split("--")[1])),1==$("#choice-container_"+b+"_"+g).attr("value")&&(c+=parseInt(f[g].split("--")[1]));a+=d}playSound(baseUrl+"/audio/result_2.mp3");b='<div class="title">'+q+"</div>";d="";d='<span class="total">'+c+"</span>/<span>"+a+"</span>";a="";$("#topbar").html(b);$(".score").html(d);for(b=0;b< j.length;b++)a+='<div class="result" id="result_'+b+'"></div>';$("#yourResult").append(a);for(b=0;b<j.length;b++)$("#result_"+b).html(m[b]);$("#result-container").show();a=$("#result-container").height()+40;$("#main-board").css({"min-height":a+"px"});for(b=0;b<j.length;b++)if(c<=parseInt(j[b])){$("#result_"+b).show();break}}})});
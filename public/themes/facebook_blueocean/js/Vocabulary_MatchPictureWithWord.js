$(document).ready(function(){function m(){var b=new Image;b.onload=function(){e=this.height/this.width;$(".represent-picture").height($(".represent-picture").width()*e);$(".character-picture").height($(".character-picture").width()*e)};b.src=activityContent.group[0].character;var a=0;$(".sentence").each(function(){a=$(this).height()>a?$(this).height():a});$(".sentence").height(a);7>f&&(b=Math.floor((960/f-$(".character-picture").width())/2),$(".character-picture-holder").css({"margin-left":b+"px",
"margin-right":b+"px"}),$(".sentence-holder").css({"margin-left":b+4+"px","margin-right":b+5+"px"}))}function l(){a=[];var b=[],c="",g="",d=shuffle(activityContent.group);for(i=0;i<f;i++)-1==$.inArray(d[i].character,a)?(b[b.length]='<div class="character-picture-holder" id="picture_'+a.length+'" ><img class="character-picture" src="'+resourceUrl+d[i].character+'" pictureId="'+a.length+'" /></div>',void 0!=d[i].words&&(g+='<div class="sentence-picture-wrap"><div class="sentence-holder"><div class="represent-picture represent-picture-normal" pictureId="'+
a.length+'"></div><span class="sentence" sentenceId="'+i+'">'+d[i].words+"</span></div></div>"),a[a.length]=d[i].character):void 0!=d[i].words&&(g+='<div class="sentence-picture-wrap"><div class="sentence-holder"><div class="represent-picture represent-picture-normal" pictureId="'+$.inArray(d[i].character,a)+'"></div><span class="sentence">'+d[i].words+"</span></div></div>");b=shuffle(b);for(k=0;k<b.length;k++)c+=b[k];$("#pictures-container").append(c+'<div class="clear-both"></div>');$("#sentences-container").append(g);
m();$(".character-picture").draggable({revert:"invalid",helper:"clone"});$(".sentence-holder").droppable({accept:".character-picture",over:function(){$(this).children(".represent-picture").switchClass("represent-picture-normal","represent-picture-over")},out:function(){$(this).children(".represent-picture").switchClass("represent-picture-over","represent-picture-normal")},drop:function(b,a){h&&(playSound(Ucan.Resource.Audio.getClickedSound()),$(this).children(".represent-picture").switchClass("represent-picture-over",
"represent-picture-normal"),a.draggable.parent().hasClass("character-picture-holder")?(0<$(this).children(".represent-picture").children(".character-picture").length&&$("#picture_"+$(this).children(".represent-picture").children(".character-picture").attr("pictureid")).css({display:"inline"}).animate({opacity:"0.3"},500,function(){$(this).animate({opacity:"1"},500)}),$(this).children(".represent-picture").children().remove(),$(this).children(".represent-picture").append(a.draggable.clone().css({width:"100px",
height:Math.floor(100*e)+"px"}).draggable({revert:"invalid",helper:"clone"})).animate({opacity:"0.3"},500,function(){$(this).animate({opacity:"1"},500)}),a.draggable.parent().css({display:"none"})):(a.draggable.parent().append($(this).children(".represent-picture").children()).animate({opacity:"0.3"},500,function(){$(this).animate({opacity:"1"},500)}),$(this).children(".represent-picture").append(a.draggable.clone().draggable({revert:"invalid",helper:"clone"})).animate({opacity:"0.3"},500,function(){$(this).animate({opacity:"1"},
500)}),a.draggable.remove()))}});$("#pictures-container").droppable({accept:".character-picture",drop:function(a,b){h&&(playSound(Ucan.Resource.Audio.getClickedSound()),b.draggable.parent().hasClass("character-picture-holder")||($("#picture_"+b.draggable.attr("pictureid")).css({display:"inline"}).animate({opacity:"0.3"},500,function(){$(this).animate({opacity:"1"},500)}),b.draggable.remove()))}})}var f=activityContent.group.length,h=!0,a=[],e=0.75,j=!0;l();var c=0;$("#loadResult").click(function(){h&&
(h=!1,$(".character-picture").draggable("disable"),playSound(Ucan.Resource.Audio.getShowResultSound()),c=0,$(".sentence-holder").each(function(){$(this).children(".represent-picture").attr("pictureId")==$(this).children(".represent-picture").children("img").attr("pictureId")?(c++,$(this).children(".represent-picture").append('<div class="represent-picture-mask"><img class="true-icon true-false-icon" src="'+baseUrl+'/themes/blueocean/img/true-false-tick-white-108.png" /></div>')):$(this).children(".represent-picture").append('<div class="represent-picture-mask"><img class="false-icon true-false-icon" src="'+
baseUrl+'/themes/blueocean/img/true-false-cross-white-108.png" /></div>')}),$(".represent-picture-mask").height($(".represent-picture-mask").width()*e),$(".true-icon, .false-icon").ucanAnimateTrueFalseIcon(),$("#num-of-correct-answers-result").text(c+"/"+f),score=Math.floor(100*(c/f)),$("#score-text").text(score),$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed()),j=!0)});$("#redo").click(function(){j&&(j=!1,$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),
function(){h=!0;$("#pictures-container").html("");$("#sentences-container").html("");c=0;l()}))});$("#show-answer").click(function(){$(".represent-picture").each(function(){$(this).html("");$(this).append('<img class="character-picture" src="'+a[$(this).attr("pictureId")]+'" style="width: 100px; height: '+Math.floor(100*e)+'px">').fadeOut(500).fadeIn(500)})})});
$(document).ready(function(){function n(a,b,c,e){this.id=a;this.title=b;this.imageUrl=c;this.wordList=e}function o(a,b,c){this.id=a;this.groupID=b+p;this.content=c}function j(){var d=[];for(a=0;a<b.length;a++)for(c=0;c<b[a].wordList.length;c++)d.push(b[a].wordList[c].content);shuffle(d);for(a=0;a<d.length;a++)$("#word-list").append('<div class="word global-correct-column-word-in-list"><span>'+d[a]+'</span><div class="icon-true-false"></div></div>')}function k(){if(!l){for(a=0;a<b.length;a++)$("#group-titles").append('<div class="cell global-blue-bar">'+
(b[a].title?b[a].title:"")+"</div>"),$("#group-content-table").append('<div class="cell global-border-color-gray-3" data-group-id="'+b[a].id+'"></div>'),$("#key-table").append('<div class="cell global-border-color-gray-3"></div>'),b[a].imageUrl&&$("#group-content-table .cell").eq(a).append('<img src="'+b[a].imageUrl+'" alt="Group image" />');activityContent.listening_audio&&($("#group-titles").prepend('<div class="cell empty global-blue-bar"></div>'),$("#group-content-table").prepend('<div class="cell audio global-border-color-gray-3"></div>'),
$("#group-content-table .cell.audio").append($("#listening-audio")),$("#key-table").prepend('<div class="cell empty global-border-color-gray-3"></div>'));4<b.length&&$("#group-content-table .cell > img").css("max-width","90%")}}function m(){$("#group-content-table .word, #word-list .word").draggable({helper:"clone",revert:"invalid",stack:".text",refreshPositions:!0});$("#group-content-table > .cell").not(".audio").droppable({accept:".word",over:function(){$(this).addClass("over")},out:function(){$(this).removeClass("over")},
drop:function(a,b){playSound(Ucan.Resource.Audio.getClickedSound());$(this).append(b.draggable);$(this).removeClass("over")}});$("#word-list").droppable({drop:function(a,b){playSound(Ucan.Resource.Audio.getClickedSound());$(this).append(b.draggable);$(this).removeClass("over")},over:function(){$(this).addClass("over")},out:function(){$(this).removeClass("over")}});$("#loadResult").click(function(){if(g){g=!1;$(".word").draggable("disable");playSound(Ucan.Resource.Audio.getShowResultSound());var d=
0;$("#group-content-table .word").each(function(){var f=$(this).parent().attr("data-group-id"),e;a:{e=$(this).text();for(a=0;a<b.length;a++)for(c=0;c<b[a].wordList.length;c++)if(compareTwoString(htmlEncode(b[a].wordList[c].content),e)){e=b[a].id;break a}e=null}f==e?(d++,insertTrueFalseIconAfter(!0,$(this).children("span"))):insertTrueFalseIconAfter(!1,$(this).children("span"))});$(".word .true-icon, .word .false-icon").ucanAnimateTrueFalseIcon();10>d?$("#num-of-correct-answers-result").html("0"+d):
$("#num-of-correct-answers-result").html(d);var f=0;for(a=0;a<b.length;a++)f+=b[a].wordList.length;score=Math.floor(100*(d/f));$("#num-of-correct-answers-result").text(d+"/"+f);$("#score-text").text(score);$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed());i=!0}});$("#show-answer").click(function(){0<$("#key-table .cell").children().size()||($("#key-table .cell").not(".empty").each(function(d){for(a=0;a<b[d].wordList.length;a++){var c=b[d].wordList[a];$(this).append('<div class="key">'+
c.content+"</div>")}}),$("#key-table").show().children(".cell").css("display","table-cell").stop(!0,!0).fadeOut(500).fadeIn(500))});$("#redo").click(function(){i&&(i=!1,$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),function(){l=g=!0;$("#group-content-table .cell").not(".audio").each(function(){0<$(this).children("img").size()?$("#group-content-table .cell > img").siblings().remove():$(this).html("")});$("#word-list").html("");$("#key-table").hide().children(".cell").html("");
j();k();m()}))})}var p=7,a,c,g=!0,l=!1,i=!1,b=function(){var b=[],f=0;for(a=0;a<activityContent.group.length;a++){var h=activityContent.group[a],e=[],g=$.trim(h.words).split(",");for(c=0;c<g.length;c++)e.push(new o(f++,h.category_title,g[c]));b.push(new n(a,h.category_title,h.image,e))}return b}();j();k();m()});
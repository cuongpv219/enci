$(document).ready(function(){function k(){f=!0;$(".select-word").draggable("enable").removeClass("select-word-match").addClass("select-word-unmatch");var a="";g=shuffle(e);for(var c=0;c<d;c++)a+='<div class="group '+(c!=d-1?"middle-group":"last-group")+'"><div id="word_'+(c+1)+'" class="word-container word-container-unmatch"></div><div id="sentence_'+(c+1)+'" class="sentence-container">'+g[c][1]+"</div></div>";$("#reading-board").append('<div id="white"></div>');$("#sentence-container").append(a); a=Math.max(500,$("#activity-board").height());$("#reading-board ").height(a-40);$("#activity-board").height(a);$("#reading-container").height(a-40);$("#activity-container").height(a+$("#activity-example").height()+20);$("#sentence-container").height(a-170);$(".word-container").draggable({revert:"invalid",helper:"clone",disable:"true"});$(".group").droppable({accept:".select-word,.word-container",over:function(){$(this).children(".word-container").removeClass("word-container-unmatch word-container-match").addClass("word-container-over")}, out:function(){""!=$(this).children(".word-container").text()?$(this).children(".word-container").removeClass("word-container-over").addClass("word-container-match"):$(this).children(".word-container").removeClass("word-container-over").addClass("word-container-unmatch")},drop:function(a,b){$(this).children(".word-container").removeClass("word-container-over").addClass("word-container-match");if(b.draggable.hasClass("select-word"))b.draggable.removeClass("select-word-unmatch").addClass("select-word-match").draggable("disable"), ""!=$(this).children(".word-container").text()&&$('.select-word[data-index="'+$(this).children(".word-container").attr("data-index")+'"]').removeClass("select-word-match").addClass("select-word-unmatch").draggable("enable").fadeOut(500).fadeIn(500),$(this).children(".word-container").text(b.draggable.text()).draggable("enable"),$(this).children(".word-container").attr("data-index",b.draggable.attr("data-index"));else{var c=$(this).children(".word-container").text(),d=$(this).children(".word-container").attr("data-index"); if($(this).children(".word-container").attr("id")==b.draggable.attr("id"))return;$(this).children(".word-container").text(b.draggable.text());$(this).children(".word-container").attr("data-index",b.draggable.attr("data-index"));b.draggable.text(c).attr("data-index",d);$(this).children(".word-container").draggable("enable");""==c&&b.draggable.removeClass("word-container-match").addClass("word-container-unmatch").draggable("disable")}playSound(Ucan.Resource.Audio.getClickedSound())}});$("#reading-board").droppable({accept:".word-container", drop:function(a,b){b.draggable.draggable("disable");$('.select-word[data-index="'+b.draggable.attr("data-index")+'"]').removeClass("select-word-match").addClass("select-word-unmatch").draggable("enable").fadeOut(200).fadeIn(200);b.draggable.fadeOut(200,function(){$(this).text("").attr("data-index","").removeClass("word-container-match").addClass("word-container-unmatch")}).fadeIn(200);playSound(Ucan.Resource.Audio.getClickedSound())}})}var e=[],g=[],f=!0,j=!1;$(".select-word").each(function(){var a= $(this).text().split("--");e[e.length]=a;$(this).text(a[0]).attr("data-index",e.length).show()});var d=e.length;$(".select-word").draggable({revert:"invalid",helper:"clone",start:function(a,c){$(this).data("draggable").offset.click.top=-7;$("#draggable-holder").css("top",$("#reading-container .jspPane").css("top"));$("#draggable-holder").append(c.helper)}});k();$("#reading-container").ucanJScrollPane("#reading-board");var h=0;$("#loadResult").click(function(){if(f){f=!1;$(".ui-draggable").draggable("disable"); playSound(Ucan.Resource.Audio.getShowResultSound());for(i=h=0;i<d;i++)$("#word_"+(i+1)).text().toLowerCase()==g[i][0].toLowerCase()?(h++,insertTrueFalseIconAfter(!0,$("#sentence_"+(i+1)))):insertTrueFalseIconAfter(!1,$("#sentence_"+(i+1)));$(".true-icon, .false-icon").ucanAnimateTrueFalseIcon();$("#num-of-correct-answers-result").text(h+"/"+d);score=Math.floor(100*(h/d));$("#score-text").text(score);$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed());j=!0}});$("#redo").click(function(){j&& (j=!1,$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),function(){f=!0;$("#sentence-container").html("");k()}))});$("#show-answer").click(function(){for(var a=0;a<d;a++)$("#word_"+(a+1)).text(g[a][0]);$(".word-container").removeClass("word-container-unmatch").addClass("word-container-match").fadeOut(500).fadeIn(500)})});
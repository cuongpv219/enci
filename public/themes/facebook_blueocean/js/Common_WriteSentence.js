$(document).ready(function(){function m(){var b='<ul id="sentences">',a='<ul id="sentences">';for(i=0;i<c;i++)0==i%2?b+='<li class="sentence"><span class="order-char">'+(i+1)+". </span>"+activityContent.group[i].sentence+'<span class="true-false-icon"></span><br><span class="textbox"><textarea class="text" type="text" tabindex="'+(i+1)+'"></textarea></span><span class="diff-container"></span></li> ':a+='<li class="sentence"><span class="order-char">'+(i+1)+". </span>"+activityContent.group[i].sentence+
'<span class="true-false-icon"></span><br><span class="textbox"><textarea class="text" type="text" tabindex="'+(i+1)+'"></textarea></span><span class="diff-container"></span></li> ';b+="</ul>";a+="</ul>";$("#left-sentence-list").append($(b));$("#right-sentence-list").append($(a));$(".text:first").focus()}multiLangSystem.title_difference="en"==defaultLanguage?"Difference":"So s\u00e1nh";var c=activityContent.group.length,f=0,k=!0,l=!1;m();$("#loadResult").click(function(){k&&(k=!1,playSound(Ucan.Resource.Audio.getShowResultSound()),
f=0,$(".sentence").each(function(){for(var b=$(this).children(".textbox").children().attr("tabindex")-1,a=activityContent.group[b].result.split("/"),c=!1,e=0,g=0,h=null!=$(this).children(".textbox").children().val()?$(this).children(".textbox").children().val():"",d=0;d<a.length;d++){var j=htmlEncode(a[d]);if(j.toLowerCase().replace(/[^A-z0-9']/g," ").replace(/ +/g," ").replace(/^\s+|\s+$/g,"")==h.toLowerCase().replace(/[^A-z0-9']/g," ").replace(/ +/g," ").replace(/^\s+|\s+$/g,"")){c=!0;g=0;e=d;break}else 0==
d?(e=0,g=getNumOfDiff(j,h)):g>getNumOfDiff(j,h)&&(e=d,g=getNumOfDiff(j,h))}c?(f++,a='<br class="clear"><span class="result" style="display: none; "> '+a[e]+"</span>",$(this).children().hasClass("result")&&$(this).children(".result").remove(),$(this).children(".textbox").after(a),$(this).children(".true-false-icon").children().remove(),insertTrueFalseIcon(!0,$(this).children(".true-false-icon"))):(a='<br class="clear"><span class="result"> '+a[e]+"</span>",$(this).children().hasClass("result")&&$(this).children(".result").remove(),
$(this).children(".textbox").after(a),$(this).children(".true-false-icon").children().remove(),insertTrueFalseIcon(!1,$(this).children(".true-false-icon")),$(this).children(".diff-container").children().hasClass("showdiff")||($(this).children(".diff-container").append('<br><span id="showdiff'+b+'" class ="showdiff">'+multiLangSystem.title_difference+"</span> "),$("#showdiff"+b).click(function(){if($(this).parent().children().hasClass("difference"))$(this).parent().children(".difference").remove();
else{var a=$(this).parent().parent().children(".result").text(),a='<span class="difference">'+getCompareSentence(a,$(this).parent().parent().children(".textbox").children("textarea").val())+"</span>";$(this).parent().append(a);0!=$(this).parent().children(".difference").children("add").length&&0!=$(this).parent().children(".difference").children("rem").length?($(this).parent().children(".difference").children("add").css({color:"#fff","font-size":"0px"}),$(this).parent().children(".difference").children("rem").css({color:"#000",
"text-decoration":""}),$(this).parent().children(".difference").children("rem").animate({color:"#808080",opacity:"0.3"},1E3,function(){$(this).css({"text-decoration":"line-through"});$(this).parent().children("add").animate({color:"#FF0000","font-size":"14px"},500)})):0!=$(this).parent().children(".difference").children("add").length?($(this).parent().children(".difference").children("add").css({color:"#fff","font-size":"0px"}),$(this).parent().children(".difference").children("add").animate({color:"#FF0000",
"font-size":"14px"},500)):0!=$(this).parent().children(".difference").children("add").length&&($(this).parent().children(".difference").children("rem").css({color:"#000","text-decoration":""}),$(this).parent().children(".difference").children("rem").animate({color:"#808080",opacity:"0.3"},1E3,function(){$(this).css({"text-decoration":"line-through"})}))}})))}),$(".true-icon, .false-icon").ucanAnimateTrueFalseIcon(),$("#num-of-correct-answers-result").text(f+"/"+c),score=Math.floor(100*(f/c)),$("#score-text").text(score),
$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed()),l=!0)});$("#redo").click(function(){l&&(l=!1,$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),function(){k=!0;$("#left-sentence-list").html("");$("#right-sentence-list").html("");m()}))});$("#show-answer").click(function(){$(".result").css({display:""}).animate({opacity:"0.3"},500,function(){$(this).animate({opacity:"1"},500)})})});
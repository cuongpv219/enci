var unShowClickResult=0,numViewedPage=0,canPlay=!0,count,canClickRedo=!1,answers=[],score; $(document).ready(function(){function c(a){$(".global-tab-container").ucanMoveToTab(a);$(".dialog-audio-container").hide();$(".cp-jplayer").jPlayer("stop");$(".parapara").hide();$("#paragraph_"+a).show();$("#dialog-audio-container-"+a).show();$("#dialog-audio-"+a).jPlayer("play");$("#sentence-button_"+a).addClass("selected");d=parseInt(a);numViewedPage++}function e(){answers=[];for(var a="",b=0;b<count;b++)a+='<div class="parapara" id="paragraph_'+b+'">'+activityContent.group[b].paragraph+"</div>", $("#paragraph-number").append('<div id="sentence-button_'+b+'" data-order="'+b+'" class="inactive-button unselected">'+(b+1)+"</div>");b=/\[([^\]])+\]/g;answers=a.match(b);a=a.replace(b,'<span class="blank"><input type="text" class="text"/></span>');$("#paragraph-container").append($(a));c(0);$(".inactive-button").click(function(){var a=$(this).attr("data-order");c(a)});$(".text:first").focus()}count=activityContent.group.length;var d=0;e();2>activityContent.group.length&&($("#paragraph-number").hide(), $("#prev-link").hide(),$("#next-link").hide(),$("#loadResult").css({"float":"none",margin:"0 auto"}));$("#next-link").click(function(){d<count-1&&c(d+1)});$("#prev-link").click(function(){d>0&&c(d-1)});$("#show-answer").click(function(){var a=0;$(".text").each(function(){var b=htmlEncode(answers[a]),b=b.substring(1,b.length-1);$(this).val(b);a++});$(".text").css("width","").fadeOut(500).fadeIn(500)});$("#loadResult").click(function(){$(document).keyup(function(a){a.keyCode==13&&$("#multipage-confirm-dialog-button-no").click()}); if(numViewedPage==1&&count>1){unShowClickResult++;if(unShowClickResult==1){$(".overlay-black").show();$("#multipage-confirm-dialog").fadeIn(500)}}else loadResult()});$("#redo").click(function(){numViewedPage=unShowClickResult=0;if(canClickRedo){canClickRedo=false;canPlay=true;$("#show-result").hide("slide",{direction:"left"},Ucan.Constants.getHideResultSpeed(),function(){$("#paragraph-number").html("");$("#paragraph-container").html("");e()})}})}); function checkTextTypedByLearner(c,e){var d=e.split("/");for(i=0;i<d.length;i++)if(isEqualString(c,d[i]))return!0;return!1} function loadResult(){if(canPlay){canPlay=!1;$(".cp-jplayer").jPlayer("stop");playSound(Ucan.Resource.Audio.getShowResultSound());var c=numberOfTrueAnswers=0;$(".text").each(function(){ans=htmlEncode(answers[c]);checkTextTypedByLearner($(this).val(),ans.substring(1,ans.length-1))?(numberOfTrueAnswers++,insertTrueFalseIconAfter(!0,this)):insertTrueFalseIconAfter(!1,this);c++});$(".true-icon").css({margin:"-2px 2px 0px 1px","box-shadow":"none",border:"none",width:"18px",height:"18px"});$(".false-icon").css({margin:"-2px 2px 0px 1px", "box-shadow":"none",border:"none",width:"18px",height:"18px"});$(".true-icon, .false-icon").ucanAnimateTrueFalseIcon();$("#num-of-correct-answers-result").text(numberOfTrueAnswers+"/"+answers.length);score=Math.floor(100*(numberOfTrueAnswers/answers.length));$("#score-text").text(score);$("#show-result").show("slide",{direction:"left"},Ucan.Constants.getShowResultSpeed());canClickRedo=!0}};